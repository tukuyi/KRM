scripted_gui = {
	SZC_KMD_god_arrive_gui = {
		context_type = decision_category
		window_name = "SZC_KMD_god_arrive_gui"

		dynamic_lists = {
			SZC_KMD_GOD_main_gridbox = {
				array = ROOT.SZC_KMD_gods_array
				index = i
				value = SZC_KMD_chosen_god
				entry_container = SZC_KMD_GOD_entry
				change_scope = yes
			}
		}

		properties = {
			SZC_KMD_god_arrive_icon = {
				image = "GFX_KMD_GUI_[?SZC_KMD_chosen_god.GetTokenKey]_statue"
			}
		}

		effects = {
			KMD_action_god_arrive_button_click = {
				add_political_power = -100
				meta_effect = {
					text = {
						[KMD_GOD] = { custom_effect_tooltip = character_becomes_a_general }
						hidden_effect = {
							[KMD_GOD] = {
								SZC_recruit_character_effect = yes
							}
						}
						
						
					}
					KMD_GOD = "[?SZC_KMD_chosen_god.GetTokenKey]"
				}
				set_temp_variable = { KMD_chk = var:SZC_KMD_chosen_god }
				hidden_effect = {
					KMD_GOD_EVENT = yes
				}
				set_country_flag = KMD_GOD_recently_god_arrived
				if = {
					limit = {
						has_completed_focus = SZC_KMD_expand_temples
					}
					set_temp_variable = { temp_KMD_god_arrive_time = 35 }
					activate_mission = SZC_KMD_god_arrive_mission
				}
				else = {
					set_temp_variable = { temp_KMD_god_arrive_time = 70 }
					activate_mission = SZC_KMD_god_arrive_mission
				}
			}
			KMD_action_god_stronger_button_click = {
				add_command_power = -20
				meta_effect = {
					text = {
						[KMD_GOD] = {
							add_temporary_buff_to_units = {
								combat_offense = 0.35
								combat_breakthrough = 0.35
								war_support_reduction_on_damage = -0.5
								days = 90
							}	
						}
					}
					KMD_GOD = "[?SZC_KMD_chosen_god.GetTokenKey]"
				}
				set_country_flag = KMD_GOD_recently_god_stronger
				if = {
					limit = {
						has_completed_focus = SZC_KMD_one_step_to_eternality
					}
					set_temp_variable = { temp_KMD_god_stronger_time = 45 }
					activate_mission = SZC_KMD_god_stronger_mission
				}
				else = {
					set_temp_variable = { temp_KMD_god_stronger_time = 90 }
					activate_mission = SZC_KMD_god_stronger_mission
				}
			}
			KMD_action_special_idea_button_click = {
				add_political_power = -100
				add_stability = -0.03
				meta_effect = {
					text = {
						custom_effect_tooltip = [KMD_GOD]_special_idea_tt
						set_variable = { SZC_KMD_special_idea_boi = [KMD_GOD] }
						add_timed_idea = {
							idea = [KMD_GOD]_god_idea
							days = 30
						}
					}
					KMD_GOD = "[?SZC_KMD_chosen_god.GetTokenKey]"
				}
				set_variable = { SZC_KMD_special_idea_boi = var:SZC_KMD_chosen_god }
				set_country_flag = KMD_GOD_recently_special_idea
				if = {
					limit = {
						has_completed_focus = SZC_KMD_expand_temples
					}
					set_temp_variable = { temp_KMD_special_idea_time = 15 }
					activate_mission = SZC_KMD_special_idea_mission
				}
				else = {
					set_temp_variable = { temp_KMD_special_idea_time = 30 }
					activate_mission = SZC_KMD_special_idea_mission
				}
			}
		}

		triggers = {
			KMD_action_god_arrive_button_click_enabled = {
				NOT = {
					has_country_flag = KMD_GOD_recently_god_arrived
				}
				has_political_power > 99.99
				meta_trigger = {
					text = {
						NOT = { has_character = [KMD_GOD] }
					}
					KMD_GOD = "[?SZC_KMD_chosen_god.GetTokenKey]"
				}
			}
			KMD_action_god_stronger_button_click_enabled = {
				NOT = {
					has_country_flag = KMD_GOD_recently_god_stronger
				}
				meta_trigger = {
					text = {
						has_character = [KMD_GOD]
					}
					KMD_GOD = "[?SZC_KMD_chosen_god.GetTokenKey]"
				}
				command_power > 19.99
			}
			KMD_action_special_idea_button_click_enabled = {
				NOT = {
					has_country_flag = KMD_GOD_recently_special_idea
				}
				has_political_power > 99.99
				has_stability > 0.15
				meta_trigger = {
					text = {
						has_character = [KMD_GOD]
					}
					KMD_GOD = "[?SZC_KMD_chosen_god.GetTokenKey]"
				}
			}
		}
	}

	SZC_KMD_god_arrive_chouka_gui = {
		context_type = player_context
		window_name = "SZC_KMD_god_arrive_chouka_gui"

		visible = {
			has_country_flag = SZC_KMD_choukaing
		}
		
		triggers = {
			KMD_chou_arrows_visible = {
				NOT = {
					has_country_flag = KMD_chouka_show
				}
			}
			KMD_chouka_animation_1_visible = {
				has_country_flag = KMD_chouka_show
				set_temp_variable = { KMD_chouka_animation_1_frame = 0 } # 1 for looping, 0 for no looping
				multiply_temp_variable = { KMD_chouka_animation_1_frame = 256 }
				add_to_temp_variable = { KMD_chouka_animation_1_frame = 128 } # FPS
				multiply_temp_variable = { KMD_chouka_animation_1_frame = 64 }
				add_to_temp_variable = { KMD_chouka_animation_1_frame = 43 } # End frame
				multiply_temp_variable = { KMD_chouka_animation_1_frame = 64 }
				add_to_temp_variable = { KMD_chouka_animation_1_frame = 1 } # Start frame

			}

			KMD_chouka_animation_1_click_enabled = {
				has_country_flag = KMD_chouka_show
			}
			KMD_chou_result_visible = {
				has_country_flag = KMD_chouka_show_2
				NOT = {
					has_country_flag = KMD_chouka_show_bonus
				}
			}
			KMD_chou_no_result_visible = {
				has_country_flag = KMD_chouka_show_bonus
			}
		}

		effects = {
			KMD_chou_click = {
				if = {
					limit = {
						not = {
							has_country_flag = KMD_chouka_show
						}
					}
					set_country_flag = KMD_chouka_show
					scoped_sound_effect = "HIE_journal_o"
				}
				else_if = {
					limit = {
						NOT = {
							has_country_flag = KMD_chouka_show_2
						}
					}
					set_country_flag = KMD_chouka_show_2
					scoped_sound_effect = "HIE_journal_o"
					SZC_KMD_chouka_effect = yes
				}
				else_if = {
					limit = {
						NOT = {
							has_country_flag = KMD_chouka_show_3
						}
					}
				}
				else = {
					clr_country_flag = SZC_KMD_choukaing
					clr_country_flag = KMD_chouka_show
					clr_country_flag = KMD_chouka_show_2
					clr_country_flag = KMD_chouka_show_3
					clr_country_flag = KMD_chouka_show_bonus
					set_variable = { SZC_KMD_your_god = 0 }
				}
			}
			KMD_chou_result_click = {
				if = {
					limit = {
						NOT = {
							has_country_flag = KMD_chouka_show_3
						}
					}
					add_to_array = { ROOT.SZC_KMD_gods_array = var:SZC_KMD_your_god }
					set_country_flag = KMD_chouka_show_3
				}
				else = {
					clr_country_flag = SZC_KMD_choukaing
					clr_country_flag = KMD_chouka_show
					clr_country_flag = KMD_chouka_show_2
					clr_country_flag = KMD_chouka_show_3
					set_variable = { SZC_KMD_your_god = 0 }
				}
			}
			KMD_chou_no_result_click = {
				if = {
					limit = {
						NOT = {
							has_country_flag = KMD_chouka_show_3
						}
					}
					KMD_only_bonus_get = yes
					set_country_flag = KMD_chouka_show_3
				}
				else = {
					clr_country_flag = SZC_KMD_choukaing
					clr_country_flag = KMD_chouka_show
					clr_country_flag = KMD_chouka_show_2
					clr_country_flag = KMD_chouka_show_3
					clr_country_flag = KMD_chouka_show_bonus
					set_variable = { SZC_KMD_your_god = 0 }
				}
			}
		}

		properties = {
			KMD_chouka_animation_1 = {
				frame = KMD_chouka_animation_1_frame
			}
			KMD_chou_result = {
				image = "GFX_KMD_GUI_[?SZC_KMD_your_god.GetTokenKey]_statue"
			}
		}

	}

	SZC_KMD_bingfa_gui = {
		context_type = decision_category
		window_name = "SZC_KMD_bingfa_gui"


		properties = {
			KMD_bingfa_sheng = {
				image = "[KMD_bingfa_sheng_check]"
			}
			KMD_bingfa_jiao = {
				image = "[KMD_bingfa_jiao_check]"
			}
			KMD_bingfa_bai = {
				image = "[KMD_bingfa_bai_check]"
			}
			KMD_bingfa_ai = {
				image = "[KMD_bingfa_ai_check]"
			}
		}
	}

	SZC_KMD_chengxun_home = {
		context_type = decision_category
		window_name = "SZC_KMD_chengxun_home"


		properties = {
			KMD_chengxun_visual = {
				image = "GFX_HLZJ_[?SZC_KMD_chosen_clothe.GetTokenKey]_visual"
			}
		}

		effects = {
			KMD_chengxun_wardrobe_click = {
				if = {
					limit = {
						has_country_flag = SZC_KMD_chengxun_home_selecting
					}
					clr_country_flag = SZC_KMD_chengxun_home_selecting
				}
				else = {
					set_country_flag = SZC_KMD_chengxun_home_selecting
				}
			}
		}
	}

	SZC_KMD_chengxun_clothes_gui = {
		context_type = player_context
		window_name = "SZC_KMD_chengxun_clothes_gui"

		visible = {
			has_country_flag = SZC_KMD_chengxun_home_selecting
		}

		dynamic_lists = {
			SZC_KMD_chengxun_clothes_gridbox = {
				array = ROOT.SZC_KMD_chengxun_clothes
				index = i
				value = SZC_KMD_chengxun_clothe
				entry_container = SZC_KMD_chengxun_clothe_entry
				change_scope = yes
			}
		}

		effects = {
			KMD_chengxun_clothes_gui_button_close_click = {
				clr_country_flag = SZC_KMD_chengxun_home_selecting
			}
			SZC_KMD_chengxun_clothe_icon_click = {
				set_variable = { SZC_KMD_chosen_clothe = var:SZC_KMD_chengxun_clothe }
				meta_effect = {
						text = {
							SZC_liu_chengxun = {
								set_portraits = {
									civilian = {
										large = "GFX_portrait_[CLOTHE]_large"
									}
								}
							}
						}
						CLOTHE = "[?SZC_KMD_chengxun_clothe.GetTokenKey]"
				}
				clr_country_flag = SZC_KMD_chengxun_home_selecting
			}
		}

		properties = {
			SZC_KMD_chengxun_clothe_icon = {
				image = "GFX_HLZJ_[?SZC_KMD_chengxun_clothe.GetTokenKey]_clothe"
			}
		}
	}

}
